---
inclusion: always
---

# éƒ¨ç½²æµç¨‹

## ğŸš€ æ ‡å‡†éƒ¨ç½²æµç¨‹

### 1. ä¿®æ”¹ä»£ç ï¼ˆæœ¬åœ°ä¸»é¡¹ç›®ï¼‰
Kiro åœ¨ `H:\code2\gongxutg\` ä¸­ä¿®æ”¹ä»£ç 

### 2. åŒæ­¥åˆ°äºŒè¿›åˆ¶æºç 
å¤åˆ¶ä¿®æ”¹çš„æ–‡ä»¶åˆ° `linux_build/` å¯¹åº”ä½ç½®

### 3. éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨
ä¸Šä¼  â†’ ç¼–è¯‘ â†’ é‡å¯ï¼ˆè€—æ—¶çº¦1-2åˆ†é’Ÿï¼‰

### 4. åŠŸèƒ½éªŒè¯
æµ‹è¯•åŠŸèƒ½æ˜¯å¦æ­£å¸¸

### 5. æäº¤ä»£ç 
æµ‹è¯•é€šè¿‡åæäº¤åˆ° Git ä»“åº“

## ğŸ“¦ æœ¬åœ°å¼€å‘éƒ¨ç½²

### å¿«é€Ÿå¯åŠ¨ï¼ˆæ¨èï¼‰
```bash
# Windows
start_local_dev.bat

# Linux/Mac
./start_local_dev.sh
```

### æ‰‹åŠ¨å¯åŠ¨
```bash
# 1. å¯åŠ¨ API æœåŠ¡
python3 run_api.py

# 2. å¯åŠ¨ Bot æœåŠ¡ï¼ˆæ–°ç»ˆç«¯ï¼‰
python3 run_bot.py

# 3. å¯åŠ¨å®šæ—¶ä»»åŠ¡ï¼ˆå¯é€‰ï¼‰
python3 start_scheduler.py
```

### æŸ¥çœ‹æ—¥å¿—
```bash
# å®æ—¶æŸ¥çœ‹æ—¥å¿—
tail -f logs/app.log
tail -f logs/api.log
tail -f logs/bot.log
```

## ğŸ“¦ åŒæ­¥åˆ°äºŒè¿›åˆ¶æºç 

### å•æ–‡ä»¶åŒæ­¥
```bash
# Windows CMD/PowerShell
# ä¾‹å¦‚ï¼šä¿®æ”¹äº† src/models/database.py
copy src\models\database.py linux_build\src\models\database.py
```

### æ‰¹é‡åŒæ­¥ï¼ˆä¿®æ”¹å¤šä¸ªæ–‡ä»¶æ—¶ï¼‰
```bash
# åŒæ­¥æ•´ä¸ªç›®å½•
xcopy /E /Y src\models\*.py linux_build\src\models\
```

### âš ï¸ é‡è¦è§„åˆ™
- `linux_build/` åªæ”¾æºä»£ç æ–‡ä»¶
- ä¸è¦æ”¾æµ‹è¯•æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ã€æ–‡æ¡£
- ä¿æŒä¸ä¸»é¡¹ç›®ä»£ç åŒæ­¥

## ğŸš€ éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨

### è¿æ¥æœåŠ¡å™¨
```bash
# SSH è¿æ¥
ssh -i C:\Users\Administrator\.ssh\id_rsa -p 1991 root@103.121.92.216
```

### â±ï¸ éƒ¨ç½²æ—¶é—´
- **ç¼–è¯‘æ—¶é—´**: 1-2åˆ†é’Ÿ
- **æ€»è€—æ—¶**: çº¦2-3åˆ†é’Ÿï¼ˆä¸Šä¼  + ç¼–è¯‘ + é‡å¯ï¼‰

### ä¸Šä¼ å•ä¸ªæ–‡ä»¶
```bash
# ä¸Šä¼ åˆ°ç¼–è¯‘ç›®å½•
scp -i C:\Users\Administrator\.ssh\id_rsa -P 1991 linux_build/src/models/database.py root@103.121.92.216:/srv/linux_build/src/models/
```

### ä¸Šä¼ æ•´ä¸ªç›®å½•
```bash
# ä¸Šä¼ æ•´ä¸ª src ç›®å½•
scp -i C:\Users\Administrator\.ssh\id_rsa -P 1991 -r linux_build/src root@103.121.92.216:/srv/linux_build/
```

### ç¼–è¯‘å’Œé‡å¯æœåŠ¡
```bash
# åœæ­¢ â†’ ç¼–è¯‘ â†’ å¤åˆ¶ â†’ å¯åŠ¨ï¼ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰
ssh -i C:\Users\Administrator\.ssh\id_rsa -p 1991 root@103.121.92.216 "supervisorctl stop danbao:danbao_00 danbao_api:danbao_api_00 && cd /srv/linux_build && python3 build_optimized.py && cp -r release/* /srv/danbao/ && supervisorctl start danbao:danbao_00 danbao_api:danbao_api_00"

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
ssh -i C:\Users\Administrator\.ssh\id_rsa -p 1991 root@103.121.92.216 "supervisorctl status danbao: danbao_api:"

# æŸ¥çœ‹æ—¥å¿—
ssh -i C:\Users\Administrator\.ssh\id_rsa -p 1991 root@103.121.92.216 "tail -f /srv/danbao/logs/app.log"
```

### ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰
```bash
# ä¸Šä¼  â†’ åœæ­¢ â†’ ç¼–è¯‘ â†’ å¤åˆ¶ â†’ å¯åŠ¨ï¼ˆä¸€æ¡å‘½ä»¤ï¼Œè€—æ—¶çº¦1-2åˆ†é’Ÿï¼‰
scp -i C:\Users\Administrator\.ssh\id_rsa -P 1991 linux_build/src/models/database.py root@103.121.92.216:/srv/linux_build/src/models/ && ssh -i C:\Users\Administrator\.ssh\id_rsa -p 1991 root@103.121.92.216 "supervisorctl stop danbao:danbao_00 danbao_api:danbao_api_00 && cd /srv/linux_build && python3 build_optimized.py && cp -r release/* /srv/danbao/ && supervisorctl start danbao:danbao_00 danbao_api:danbao_api_00"
```

## ğŸ”„ å¿«é€Ÿè¿­ä»£æ¨¡å¼

é€‚ç”¨äºéœ€è¦å¤šæ¬¡è°ƒè¯•çš„åœºæ™¯ï¼š

1. Kiro ä¿®æ”¹ä»£ç 
2. ä½ é‡å¯æœåŠ¡ â†’ æµ‹è¯• â†’ åé¦ˆ
3. é‡å¤ 1-2 ç›´åˆ°æ»¡æ„
4. æäº¤åˆ° Git

**ä¼˜åŠ¿**ï¼š
- å¿«é€Ÿæµ‹è¯•
- å¯ä»¥å¤šæ¬¡è¿­ä»£
- Git å†å²æ›´æ¸…æ™°

## âš ï¸ æ³¨æ„äº‹é¡¹

### é¡¹ç›®è·¯å¾„
- **æœ¬åœ°ä¸»é¡¹ç›®**: `H:\code2\gongxutg\`
- **æœ¬åœ°äºŒè¿›åˆ¶æºç **: `H:\code2\gongxutg\linux_build\`
- **æœåŠ¡å™¨ç¼–è¯‘è·¯å¾„**: `/srv/linux_build`
- **æœåŠ¡å™¨è¿è¡Œè·¯å¾„**: `/srv/danbao` (1Panel + Supervisor)

### éƒ¨ç½²æµç¨‹
1. **ä¿®æ”¹ä¸»é¡¹ç›®ä»£ç ** â†’ æœ¬åœ°æµ‹è¯•
2. **åŒæ­¥åˆ° linux_build/** â†’ ç¡®ä¿åŒæ­¥
3. **ä¸Šä¼ åˆ°æœåŠ¡å™¨** â†’ scp ä¸Šä¼ åˆ° /srv/linux_build
4. **åœæ­¢æœåŠ¡** â†’ supervisorctl stop danbao:danbao_00 danbao_api:danbao_api_00
5. **ç¼–è¯‘** â†’ python3 build_optimized.py
6. **å¤åˆ¶** â†’ cp -r release/* /srv/danbao/
7. **å¯åŠ¨æœåŠ¡** â†’ supervisorctl start danbao:danbao_00 danbao_api:danbao_api_00

### é‡å¯æ—¶æœº
ä»¥ä¸‹æƒ…å†µéœ€è¦é‡å¯æœåŠ¡ï¼š
- ä¿®æ”¹äº† Python ä»£ç 
- ä¿®æ”¹äº†é…ç½®æ–‡ä»¶
- ä¿®æ”¹äº†æ•°æ®æ¨¡å‹
- ä¿®æ”¹äº†è·¯ç”±

ä»¥ä¸‹æƒ…å†µä¸éœ€è¦é‡å¯ï¼š
- ä¿®æ”¹äº†æ–‡æ¡£
- ä¿®æ”¹äº†æµ‹è¯•ä»£ç ï¼ˆè¿è¡Œæµ‹è¯•æ—¶ä¼šé‡æ–°åŠ è½½ï¼‰

### å¸¸è§é”™è¯¯
1. **å¿˜è®°åŒæ­¥åˆ° linux_build**: ä¸»é¡¹ç›®æ”¹äº†ä½† linux_build æ²¡åŒæ­¥
2. **ç«¯å£å ç”¨**: æ£€æŸ¥ 7000/7004 ç«¯å£æ˜¯å¦è¢«å ç”¨
3. **æ•°æ®åº“é”å®š**: ç¡®ä¿æ²¡æœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶è®¿é—®æ•°æ®åº“
4. **ä¾èµ–ç¼ºå¤±**: è¿è¡Œ `pip install -r requirements.txt`
5. **Supervisor æœåŠ¡æœªå¯åŠ¨**: `supervisorctl status danbao: danbao_api:` æ£€æŸ¥çŠ¶æ€
6. **Windows å‘½ä»¤å…¼å®¹æ€§**: 
   - âŒ ä¸èƒ½ç”¨ `curl`ï¼ˆLinux å‘½ä»¤ï¼‰
   - âœ… ä½¿ç”¨ `Invoke-WebRequest`ï¼ˆPowerShellï¼‰
   - âŒ ä¸èƒ½ç”¨ `-H` å‚æ•°
   - âœ… ä½¿ç”¨ `-Headers @{}`
7. **æ•°æ®åº“æ“ä½œ**: 
   - âŒ ä¸èƒ½ç”¨ `sqlite3` å‘½ä»¤ï¼ˆæœåŠ¡å™¨æœªå®‰è£…ï¼‰
   - âœ… ä½¿ç”¨ Python è„šæœ¬æ“ä½œæ•°æ®åº“
   - ç¤ºä¾‹ï¼š`python3 fix_initiator_role.py`

## ğŸ¯ å·¥ä½œæ–¹å¼

### ä½ çš„èŒè´£
- æ‰§è¡Œå‘½ä»¤
- è¿”å›ç»“æœ
- æµ‹è¯•åŠŸèƒ½
- åé¦ˆé—®é¢˜

### Kiro çš„èŒè´£
- ä¿®å¤æ–‡ä»¶ï¼ˆæœ¬åœ°ï¼‰
- æ›´æ–°æ–‡æ¡£ï¼ˆä¸æ–°å»ºï¼‰
- æä¾›å‘½ä»¤ï¼ˆå®Œæ•´å¯æ‰§è¡Œï¼‰

### å‘½ä»¤è¦æ±‚
1. **èƒ½ä¸€æ¡æ‰§è¡Œçš„ï¼Œä¸è¦å¤šæ¡** - ç”¨ `&&` è¿æ¥
2. **å®åœ¨ä¸è¡Œæ‰åˆ†æ­¥** - æ˜ç¡®æ ‡æ³¨æ­¥éª¤
3. **åŒ…å« cd å‘½ä»¤** - åˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•
4. **æ ‡æ³¨å‘½ä»¤ç±»å‹** - PowerShell/CMD/SSH
5. **ä¸å»ºæœåŠ¡å™¨è„šæœ¬** - ç›´æ¥ç»™å‘½ä»¤

### å»ºè®®å’Œæ„è§
- âœ… å¯ä»¥ç›´æ¥æ
- âŒ ä¸è¦å»ºæ–‡æ¡£
- â“ ä¸ç¡®å®šçš„è¯¢é—®ä½ 

### æ ‡å‡†è¯æœ¯

#### å¼€å‘æ–°åŠŸèƒ½
```
å¼€å‘ XXX åŠŸèƒ½
```

#### ä¿®å¤ Bug
```
XXX æŠ¥é”™äº†ï¼Œæ—¥å¿—ï¼š[é”™è¯¯ä¿¡æ¯]
```

#### æµ‹è¯•åé¦ˆ
```
å·²æ‰§è¡Œï¼Œç»“æœï¼šæˆåŠŸ/å¤±è´¥
é”™è¯¯ï¼šXXX
```
