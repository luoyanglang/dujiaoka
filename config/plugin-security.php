<?php

return [
    
    /*
    |--------------------------------------------------------------------------
    | 插件下载白名单域名
    |--------------------------------------------------------------------------
    |
    | 只允许从这些域名下载插件，防止 SSRF 攻击
    |
    */
    'download_whitelist' => [
        'shouquan.ymd.cc',
        'cdn.ymd.cc',
        env('PLUGIN_CDN_DOMAIN', ''),
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 插件文件大小限制
    |--------------------------------------------------------------------------
    |
    | 单位：字节（默认 50MB）
    |
    */
    'max_file_size' => env('PLUGIN_MAX_SIZE', 50 * 1024 * 1024),
    
    /*
    |--------------------------------------------------------------------------
    | 允许的文件扩展名
    |--------------------------------------------------------------------------
    |
    | 插件 zip 包中允许的文件类型（白名单）
    |
    */
    'allowed_extensions' => [
        'php',
        'json',
        'md',
        'txt',
        'js',
        'css',
        'png',
        'jpg',
        'jpeg',
        'gif',
        'svg',
        'blade.php',
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 激活速率限制
    |--------------------------------------------------------------------------
    |
    | 防止暴力破解授权码
    | max_attempts: 最大尝试次数
    | decay_minutes: 限制时长（分钟）
    |
    */
    'rate_limit' => [
        'max_attempts' => env('PLUGIN_ACTIVATE_MAX_ATTEMPTS', 5),
        'decay_minutes' => env('PLUGIN_ACTIVATE_DECAY_MINUTES', 10),
    ],
    
    /*
    |--------------------------------------------------------------------------
    | 安全日志
    |--------------------------------------------------------------------------
    |
    | 是否记录详细的安全日志
    |
    */
    'security_logging' => env('PLUGIN_SECURITY_LOGGING', true),
    
    /*
    |--------------------------------------------------------------------------
    | 生产环境错误隐藏
    |--------------------------------------------------------------------------
    |
    | 生产环境是否隐藏详细错误信息
    |
    */
    'hide_errors_in_production' => env('PLUGIN_HIDE_ERRORS', true),
    
];
